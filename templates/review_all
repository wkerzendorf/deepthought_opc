<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Deepthought OPC -- Proposal Review</title>
<link rel="stylesheet" href="../css/bootstrap.min.css" type="text/css">
<script type="text/javascript" src="../js/jquery-3.3.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<script>
function updateScoreBadge(proposalID) {
    currentScore = $('#score'+proposalID).val();
    badge = $('#badgeScore'+proposalID);
    if (currentScore == '') {
        badge.addClass('badge-secondary');
        badge.removeClass('badge-success');
        badge.removeClass('badge-danger');
        badge.html('✘ No score');
    } else if (currentScore >= 0.0 && currentScore <= 5.0) {
        badge.removeClass('badge-secondary');
        badge.addClass('badge-success');
        badge.removeClass('badge-danger');
        badge.html('✔ Score: '+currentScore);
    } else {
        badge.removeClass('badge-secondary');
        badge.removeClass('badge-success');
        badge.addClass('badge-danger');
        badge.html('✘ Invalid Score: '+currentScore);
    }
}

function updateCommentsBadge(proposalID) {
    currentComments = $('#comment'+proposalID).val();
    badge = $('#badgeComments'+proposalID);
    if (currentComments.trim() == '') {
        badge.addClass('badge-secondary');
        badge.removeClass('badge-success');
        badge.removeClass('badge-danger');
        badge.html('✘ No comments');
    } else if (currentComments.length > 10) {
        badge.removeClass('badge-secondary');
        badge.addClass('badge-success');
        badge.removeClass('badge-danger');
        badge.html('✔ Comments ('+currentComments.length+' chars)');
    } else {
        badge.removeClass('badge-secondary');
        badge.removeClass('badge-success');
        badge.addClass('badge-danger');
        badge.html('✘ Comments('+currentComments.length+' chars)');
    }
}

function updateExpertiseBadge(proposalID) {
    currentExpertise = $('#ref_knowledge'+proposalID).val();
    badge = $('#badgeExpertise'+proposalID);
    if (currentExpertise == '') {
        badge.addClass('badge-secondary');
        badge.removeClass('badge-success');
        badge.html('✘ No comments');
    } else {
        badge.removeClass('badge-secondary');
        badge.addClass('badge-success');
        badge.html('✔ Expertise ('+currentExpertise+')');
    } 
}
</script>
</head>
<body>
<div class="container">
    <div class="row">
        <h1>Deepthought OPC</h1>
    </div>
    <div class="row">
        <div class="col-8 offset-md-2">
            <div>
                {# alerts will go here #}
            </div>

            <h2>Proposals for you to referee:</h2>

            <form method="post">
            
            <div class="accordion" id="proposalsAccordion">
            
            {% for proposal in proposals %}

            <div class="card">
                <div class="card-header" id="heading1">
                    <div class="row">
                    <div class="col-5">
                    <h5 class="mb-0" style="display: inline-block;">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse1" aria-expanded="true" aria-controls="collapse1">
                        #1: Title Goes Here
                    </button>
                    </h5>
                    </div>

                    <div class="col-7 text-right" style="padding-top: .5em;">
                    <span class="badge badge-secondary" id="badgeScore1">✘ No score</span>
                    <span class="badge badge-secondary" id="badgeComments1">✘ No comments</span>
                    <span class="badge badge-secondary" id="badgeExpertise1">✘ No expertise</span>
                    </div>
                    </div>
                </div>
            
                <div id="collapse1" class="collapse" aria-labelledby="heading1" data-parent="#proposalsAccordion">
                    <div class="card-body">
                    <p>{{ }}</p>

                    <p><a href="#">View Proposal PDF</a></p>

                    <div class="form-group">
                        <label for="score1">Proposal Score</label>
                        <input type="number" class="form-control" id="score1" name="score1" placeholder="0.0 - 5.0" step="0.1" min="0" max="5" onchange="updateScoreBadge(1);" onkeyup="updateScoreBadge(1);">
                    </div>

                    <div class="form-group">
                        <label for="comment1">Comments</label>
                        <textarea class="form-control" id="comment1" name="comment1" rows="3" onchange="updateCommentsBadge(1);" onkeyup="updateCommentsBadge(1);"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="ref_knowledge1">Your Expertise</label>
                        <select class="form-control" id="ref_knowledge1" name="ref_knowledge1" onchange="updateExpertiseBadge(1);">
                            <option value="">Please choose one</option>
                            <option value="1">(1) This is my field of expertise.</option>
                            <option value="2">(2) I have some general knowledge of this field.</option>
                            <option value="3">(3) I have little or no knowledge of this field.</option>
                        </select>
                    </div>
                    </div> {# /.card-body #}
                </div> {# /#collapse1 #}
            </div>

            {% endfor %}

            </div> {# /proposalsAccordion #}
            </form>

        </div>
    </div>
</div>


</body>
</html>